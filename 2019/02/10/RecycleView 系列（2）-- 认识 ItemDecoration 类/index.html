<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="前言上一篇 博客介绍了 RecycleView 的基本使用，接下来我们来给列表添加点装饰 - 分割线。 RecycleView 没有像 ListView 一样可以直接在 xml 中或者通过 setDivider（）方法设置分割线的方法。它是通过 RecycleView 的 addItemDecoration(ItemDecoration decor) 方法来设置的。很显然，我们需要传入一个 Ite">
<meta name="keywords" content="android">
<meta property="og:type" content="article">
<meta property="og:title" content="RecycleView 系列（2）-- 认识 ItemDecoration 类">
<meta property="og:url" content="https://xiaxiayang.github.io/2019/02/10/RecycleView 系列（2）-- 认识 ItemDecoration 类/index.html">
<meta property="og:site_name" content="夏霂熠雨">
<meta property="og:description" content="前言上一篇 博客介绍了 RecycleView 的基本使用，接下来我们来给列表添加点装饰 - 分割线。 RecycleView 没有像 ListView 一样可以直接在 xml 中或者通过 setDivider（）方法设置分割线的方法。它是通过 RecycleView 的 addItemDecoration(ItemDecoration decor) 方法来设置的。很显然，我们需要传入一个 Ite">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://i.loli.net/2019/02/10/5c5f84e023982.png">
<meta property="og:image" content="https://i.loli.net/2019/02/10/5c5f84e014fdc.png">
<meta property="og:image" content="https://i.loli.net/2019/02/10/5c5f84dfe7050.png">
<meta property="og:image" content="https://i.loli.net/2019/02/10/5c5f84e0153f8.png">
<meta property="og:image" content="https://i.loli.net/2019/02/10/5c5f84e016a7a.png">
<meta property="og:image" content="https://i.loli.net/2019/02/10/5c5f84e02faf8.png">
<meta property="og:updated_time" content="2019-02-10T02:00:06.178Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RecycleView 系列（2）-- 认识 ItemDecoration 类">
<meta name="twitter:description" content="前言上一篇 博客介绍了 RecycleView 的基本使用，接下来我们来给列表添加点装饰 - 分割线。 RecycleView 没有像 ListView 一样可以直接在 xml 中或者通过 setDivider（）方法设置分割线的方法。它是通过 RecycleView 的 addItemDecoration(ItemDecoration decor) 方法来设置的。很显然，我们需要传入一个 Ite">
<meta name="twitter:image" content="https://i.loli.net/2019/02/10/5c5f84e023982.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://xiaxiayang.github.io/2019/02/10/RecycleView 系列（2）-- 认识 ItemDecoration 类/"/>





  <title>RecycleView 系列（2）-- 认识 ItemDecoration 类 | 夏霂熠雨</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
<a href="https://github.com/xiaxiayang" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; left: 0; transform: scale(-1, 1);" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style></a>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">夏霂熠雨</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaxiayang.github.io/2019/02/10/RecycleView 系列（2）-- 认识 ItemDecoration 类/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xiaxiayang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/25956745?s=400&u=3b875396982ce81f05ad70778ceee4e3daf8d909&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="夏霂熠雨">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">RecycleView 系列（2）-- 认识 ItemDecoration 类</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-10T09:54:34+08:00">
                2019-02-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android/" itemprop="url" rel="index">
                    <span itemprop="name">android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/02/10/RecycleView 系列（2）-- 认识 ItemDecoration 类/" class="leancloud_visitors" data-flag-title="RecycleView 系列（2）-- 认识 ItemDecoration 类">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
				 <span>℃</span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p><a href="https://blog.csdn.net/qq_33703877/article/details/86379020" target="_blank" rel="noopener">上一篇</a> 博客介绍了 RecycleView 的基本使用，接下来我们来给列表添加点装饰 - <strong>分割线</strong>。</p>
<p>RecycleView 没有像 ListView 一样可以直接在 xml 中或者通过 <code>setDivider（）</code>方法设置分割线的方法。它是通过 RecycleView 的 <code>addItemDecoration(ItemDecoration decor)</code> 方法来设置的。很显然，我们需要传入一个 ItemDecoration  对象，这个对象是一个抽象类，官方已经提供了一种常用分割线类：DividerItemDecoration。来看一下用法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 这里 LayoutManager 为 LinearLayoutManager</span><br><span class="line">DividerItemDecoration itemDecoration = new DividerItemDecoration(this,DividerItemDecoration.VERTICAL);</span><br><span class="line">recycleView.addItemDecoration(itemDecoration )</span><br></pre></td></tr></table></figure>
<p>也很简单有木有，运行代码看下效果：<br><img src="https://i.loli.net/2019/02/10/5c5f84e023982.png" alt="1.png"><br>那这个简单的效果是如何实现的呢？前面说过 RecycleView 的分割线是由 <code>RecyclerView.ItemDecoration</code> 这个类来实现的，所以我们要先来了解一下这个类。</p>
<h4 id="一-ItemDecoration-类介绍"><a href="#一-ItemDecoration-类介绍" class="headerlink" title="一.ItemDecoration 类介绍"></a>一.ItemDecoration 类介绍</h4><p>惯例先看一下<a href="https://developer.android.com/reference/android/support/v7/widget/RecyclerView.ItemDecoration" target="_blank" rel="noopener">文档</a>中对 ItemDecoration  类的介绍：</p>
<blockquote>
<p>An ItemDecoration allows the application to add a special drawing and layout offset to specific item views from the adapter’s data set. This can be useful for drawing dividers between items, highlights, visual grouping boundaries and more.<br>All ItemDecorations are drawn in the order they were added, before the item views (in onDraw() and after the items (in onDrawOver(Canvas, RecyclerView, RecyclerView.State).<br>ItemDecoration 允许应用程序为特定的 item 视图添加一个特殊的<strong>绘图</strong>和<strong>布局偏移量</strong>。这对于绘制 items 之间的分隔线、高亮显示、可视分组等非常有用。<br>所有的 item 的装饰都是按照被添加的顺序绘制的，先于 item 的绘制(在<code>onDraw()</code> 方法中)，和在 item 绘制后 (<code>onDrawOver(Canvas, RecyclerView, RecyclerView.State)</code>方法中)。</p>
</blockquote>
<p>从这段介绍中，我们可以得到以下信息：</p>
<ul>
<li>ItemDecoration  可以为 item 添加绘图，还可以设置偏移量</li>
<li>ItemDecoration  可以用于实现 item 之间的分隔线、高亮显示、可视分组等功能</li>
<li>ItemDecoration 中的 <code>onDraw()</code> 方法先于 item 绘制，<code>onDrawOver(Canvas, RecyclerView, RecyclerView.State</code>方法执行顺序在 item 的绘制之后</li>
</ul>
<p>让我们来新建一个类，继承 RecyclerView.ItemDecoration，默认会要实现它的三个抽象方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class BasicDivider extends RecyclerView.ItemDecoration &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void onDraw(@NonNull Canvas canvas, @NonNull RecyclerView parent, @NonNull RecyclerView.State state) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public void onDrawOver(@NonNull Canvas canvas, @NonNull RecyclerView parent, @NonNull RecyclerView.State state) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public void getItemOffsets(@NonNull Rect outRect, @NonNull View view, @NonNull RecyclerView parent, @NonNull RecyclerView.State state) &#123;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>看一下文档中对这三个方法的说明：</p>
<p> <strong>1.getItemOffsets () 方法：</strong></p>
<ul>
<li>重新得到给定 item 的任何偏移量。outRect 的每个字段指定 item 视图应该插入多少像素，效果类似于 padding 或 margin。默认将 outRect 的边界设置为 0 并返回；</li>
<li>.如果这个 ItemDecoration 不影响 item 视图的位置，在 return 之前要先将 outRect的所有四个字段 (left, top, right, bottom) 设为 0；</li>
<li>如果您需要访问适配器以获取额外的数据，您可以调用 <code>getChildAdapterPosition(View)</code> 来获取该 View 在适配器中位置；</li>
</ul>
<p>这个方法中比较关键的就是第一点的理解，<strong>设置 outRect 的值，效果类似给 item 设置了 padding 或者 margin</strong>。我们可以看一下下图理解一下：<br><img src="https://i.loli.net/2019/02/10/5c5f84e014fdc.png" alt="2.png"><br>到这其实我们已经可以看到，RecycleView 是通过这个 rectRect 的值来给 item 设置“空隙”，然后达到分割线的效果。</p>
<p>为了更好的理解这个方法，我们在代码中动态设置 outRect 的四个值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">public class BasicDivider extends RecyclerView.ItemDecoration &#123;</span><br><span class="line"></span><br><span class="line">    private static final String TAG = &quot;DividerItem&quot;;</span><br><span class="line">    /**</span><br><span class="line">     * 获取 item 在四个方向上的偏移量</span><br><span class="line">     */</span><br><span class="line">    private int leftOffset;</span><br><span class="line">    private int topOffset;</span><br><span class="line">    private int rightOffset;</span><br><span class="line">    private int bottomOffset;</span><br><span class="line">    private Context context;</span><br><span class="line">    </span><br><span class="line">    public BasicDivider(Context context) &#123;</span><br><span class="line">        this(context,0,0,0,0);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public BasicDivider(Context context, int left, int top, int right, int bottom) &#123;</span><br><span class="line">        this.leftOffset = left;</span><br><span class="line">        this.topOffset = top;</span><br><span class="line">        this.rightOffset = right;</span><br><span class="line">        this.bottomOffset = bottom;</span><br><span class="line">        this.context = context;</span><br><span class="line">    &#125;</span><br><span class="line">    public void onDraw(@NonNull Canvas canvas, @NonNull RecyclerView parent, @NonNull RecyclerView.State state) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    @Override</span><br><span class="line">    public void onDrawOver(@NonNull Canvas canvas, @NonNull RecyclerView parent, @NonNull RecyclerView.State state) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public void getItemOffsets(@NonNull Rect outRect, @NonNull View view, @NonNull RecyclerView parent, @NonNull RecyclerView.State state) &#123;</span><br><span class="line">        super.getItemOffsets(outRect, view, parent, state);</span><br><span class="line">        outRect.set(leftOffset,topOffset,rightOffset,rightOffset);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>其中的 leftOffset、topOffset、rightOffset、rightOffset 由外部设置得到，这里代码省略，然后看下效果：</p>
<p>需要注意的是通过 <code>getItemOffsets</code> 方法设置分割线，分割线的颜色是 RecycleView 的 backgroundColor 的颜色。所以我们如果想修改分割线的颜色，就必须修改 recycleView 的背景色。</p>
<p>那么假设我想要一个渐变色的分割线或者其他样式的分割线怎么办呢？<br>答案就是剩下的两个方法 <code>ondraw（）</code>和 <code>onDrawOver（）</code>方法 可以上场了。</p>
<p> <strong>2.onDraw () 方法：</strong></p>
<blockquote>
<p>Draw any appropriate decorations into the Canvas supplied to the RecyclerView. Any content drawn by this method will be drawn before the item views are drawn, and will thus appear underneath the views<br>在 RecycleView 的画布中绘制任意合适的装饰。通过该方法绘制的内容将在 item 的绘制之前被绘制，因此会在 item 的下方显示</p>
</blockquote>
<p>通过这个介绍我们可以知道以下三点：</p>
<ul>
<li><strong>onDraw（） 方法的使用对象是整个 RecycleView，而不是针对单个的 item</strong></li>
<li><strong>onDraw（）方法可以绘制任何装饰（ 通过canvas可以随心所欲）</strong></li>
<li><strong>这个方法在 item 之前被绘制，因此位置计算不当，可能会出现被 item 遮挡的情况</strong></li>
</ul>
<p>那我们来想一下，如何实现在 RecycleView 背景为灰色，但分割线为 “10 px 的红色” 的功能。这里我写下我分析的步骤：</p>
<p><strong>(1).通过 getItemOffsets（）方法设置 item 的间距，预留分割线的宽度</strong><br> <strong>(2).通过 onDraw（）方法绘制分割线，具体又细分为：</strong></p>
<ul>
<li><strong>计算绘制的位置</strong>。因为canvas 是这个 RecycleView 的，所以我们要计算每条线的位置</li>
<li><strong>绘制</strong>。使用 <code>canvas.drawRect（</code>）或者 <code>canvas.drawLine（）</code> 方法进行绘制</li>
</ul>
<p>看一下主要代码实现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">// 在提供给 RecycleView 的画布中绘制适当的装饰。</span><br><span class="line">    @Override</span><br><span class="line">    public void onDraw(@NonNull Canvas canvas, @NonNull RecyclerView parent, @NonNull RecyclerView.State state) &#123;</span><br><span class="line">        Log.d(TAG,&quot;----onDraw---&quot;);</span><br><span class="line">        canvas.save();</span><br><span class="line">        final int left;</span><br><span class="line">        final int right;</span><br><span class="line">        left = 0;</span><br><span class="line">        right = parent.getRight();</span><br><span class="line">        final int childCount = parent.getChildCount();</span><br><span class="line">         bottomOffset = 10;</span><br><span class="line">        // 遍历 item，获取每个item 的位置从而定位要绘制的分割线的位置</span><br><span class="line">        for (int i = 0; i &lt; childCount; i++) &#123;</span><br><span class="line">            final View child = parent.getChildAt(i);</span><br><span class="line">            //计算分割线的位置</span><br><span class="line">            final int bottom = child.getBottom()+bottomOffset;</span><br><span class="line">            final int top = child.getBottom();</span><br><span class="line">            canvas.drawRect(left,top,right,bottom,paint);</span><br><span class="line">        &#125;</span><br><span class="line">        canvas.restore();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> //.重新得到给定 item 的任何偏移量</span><br><span class="line">    @Override</span><br><span class="line">    public void getItemOffsets(@NonNull Rect outRect, @NonNull View view, @NonNull RecyclerView parent, @NonNull RecyclerView.State state) &#123;</span><br><span class="line">        super.getItemOffsets(outRect, view, parent, state);</span><br><span class="line">        //设置 item 底部偏移 10 dp</span><br><span class="line">        outRect.bottom = 10;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>关于分割线位置的计算，我们可以借助一下图，就会很容易计算：<br><img src="https://i.loli.net/2019/02/10/5c5f84dfe7050.png" alt="3.png"><br>只要计算 A点和 D 点的坐标即可。当然，我这里写的是最简单的情况，不考虑 RecycleView 及 item 的 padding 和 margin，其实计算的时候也是应该考虑进去的。<br>然后我们运行看一下效果：<br><img src="https://i.loli.net/2019/02/10/5c5f84e0153f8.png" alt="4.png"><br>然后来验证一下，<code>onDraw（）</code>方法是在 item 之前绘制的，把上述 <code>onDraw（）</code>方法中的 <code>bottomOffset = 50</code>，也就是绘制的区域其实是 item 下方 50 px 高度的矩形。</p>
<p>然后运行，发现效果和上一张图一样。也就是说我们绘制的内容被 item 给覆盖住了。</p>
<p>所以，如果想让内容绘制在 item 之上，不被盖住，我们需要了解下面的方法。</p>
<p> <strong>3.onDrawOver () 方法：</strong><br> 与 <code>onDraw()</code> 方法作用一样，但是是在 item 之后绘制，所以不会被遮挡覆盖。</p>
<p> 我们把例子中 <code>onDraw（）</code>方法中的代码移到 <code>onDrawOver ()</code> 方法中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public void onDrawOver(@NonNull Canvas canvas, @NonNull RecyclerView parent, @NonNull RecyclerView.State state) &#123;</span><br><span class="line">       Log.d(TAG,&quot;----onDrawOver---&quot;);</span><br><span class="line">       canvas.save();</span><br><span class="line">       final int left;</span><br><span class="line">       final int right;</span><br><span class="line">       left = 0;</span><br><span class="line">       right = parent.getRight();</span><br><span class="line">       bottomOffset = 50;</span><br><span class="line">       final int childCount = parent.getChildCount();</span><br><span class="line">       for (int i = 0; i &lt; childCount; i++) &#123;</span><br><span class="line">           final View child = parent.getChildAt(i);</span><br><span class="line">           final int bottom = child.getBottom()+bottomOffset;</span><br><span class="line">           final int top = child.getBottom();</span><br><span class="line">           canvas.drawRect(left,top,right,bottom,paint);</span><br><span class="line">       &#125;</span><br><span class="line">       canvas.restore();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>然后看一下效果:<br><img src="https://i.loli.net/2019/02/10/5c5f84e016a7a.png" alt="5.png"><br>可以看到，方法中绘制的内容会覆盖在 item 之上。也就验证了 <code>onDrawOver ()</code> 方法在 item 之后绘制。</p>
<h4 id="二-解析默认分割线的实现"><a href="#二-解析默认分割线的实现" class="headerlink" title="二.解析默认分割线的实现"></a>二.解析默认分割线的实现</h4><p>了解了 <code>ItemDecoration</code> 各个方法的作用，下面我们来分析一下默认提供的分割线的内部实现，</p>
<p>先看一下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line">public class DividerItemDecoration extends RecyclerView.ItemDecoration &#123;</span><br><span class="line">    public static final int HORIZONTAL = LinearLayout.HORIZONTAL;</span><br><span class="line">    public static final int VERTICAL = LinearLayout.VERTICAL;</span><br><span class="line"></span><br><span class="line">    private static final String TAG = &quot;DividerItem&quot;;</span><br><span class="line">    private static final int[] ATTRS = new int[]&#123; android.R.attr.listDivider &#125;;</span><br><span class="line"></span><br><span class="line">    private Drawable mDivider;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Current orientation. Either &#123;@link #HORIZONTAL&#125; or &#123;@link #VERTICAL&#125;.</span><br><span class="line">     */</span><br><span class="line">    private int mOrientation;</span><br><span class="line"></span><br><span class="line">    private final Rect mBounds = new Rect();</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Creates a divider &#123;@link RecyclerView.ItemDecoration&#125; that can be used with a</span><br><span class="line">     * &#123;@link LinearLayoutManager&#125;.</span><br><span class="line">     *</span><br><span class="line">     * @param context Current context, it will be used to access resources.</span><br><span class="line">     * @param orientation Divider orientation. Should be &#123;@link #HORIZONTAL&#125; or &#123;@link #VERTICAL&#125;.</span><br><span class="line">     */</span><br><span class="line">    public DividerItemDecoration(Context context, int orientation) &#123;</span><br><span class="line">        final TypedArray a = context.obtainStyledAttributes(ATTRS);</span><br><span class="line">        mDivider = a.getDrawable(0);</span><br><span class="line">        if (mDivider == null) &#123;</span><br><span class="line">            Log.w(TAG, &quot;@android:attr/listDivider was not set in the theme used for this &quot;</span><br><span class="line">                    + &quot;DividerItemDecoration. Please set that attribute all call setDrawable()&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        a.recycle();</span><br><span class="line">        setOrientation(orientation);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Sets the orientation for this divider. This should be called if</span><br><span class="line">     * &#123;@link RecyclerView.LayoutManager&#125; changes orientation.</span><br><span class="line">     *</span><br><span class="line">     * @param orientation &#123;@link #HORIZONTAL&#125; or &#123;@link #VERTICAL&#125;</span><br><span class="line">     */</span><br><span class="line">    public void setOrientation(int orientation) &#123;</span><br><span class="line">        if (orientation != HORIZONTAL &amp;&amp; orientation != VERTICAL) &#123;</span><br><span class="line">            throw new IllegalArgumentException(</span><br><span class="line">                    &quot;Invalid orientation. It should be either HORIZONTAL or VERTICAL&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        mOrientation = orientation;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Sets the &#123;@link Drawable&#125; for this divider.</span><br><span class="line">     *</span><br><span class="line">     * @param drawable Drawable that should be used as a divider.</span><br><span class="line">     */</span><br><span class="line">    public void setDrawable(@NonNull Drawable drawable) &#123;</span><br><span class="line">        if (drawable == null) &#123;</span><br><span class="line">            throw new IllegalArgumentException(&quot;Drawable cannot be null.&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        mDivider = drawable;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onDraw(Canvas c, RecyclerView parent, RecyclerView.State state) &#123;</span><br><span class="line">        if (parent.getLayoutManager() == null || mDivider == null) &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        if (mOrientation == VERTICAL) &#123;</span><br><span class="line">            drawVertical(c, parent);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            drawHorizontal(c, parent);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void drawVertical(Canvas canvas, RecyclerView parent) &#123;</span><br><span class="line">        canvas.save();</span><br><span class="line">        final int left;</span><br><span class="line">        final int right;</span><br><span class="line">        //noinspection AndroidLintNewApi - NewApi lint fails to handle overrides.</span><br><span class="line">        if (parent.getClipToPadding()) &#123;</span><br><span class="line">            left = parent.getPaddingLeft();</span><br><span class="line">            right = parent.getWidth() - parent.getPaddingRight();</span><br><span class="line">            canvas.clipRect(left, parent.getPaddingTop(), right,</span><br><span class="line">                    parent.getHeight() - parent.getPaddingBottom());</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            left = 0;</span><br><span class="line">            right = parent.getWidth();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        final int childCount = parent.getChildCount();</span><br><span class="line">        for (int i = 0; i &lt; childCount; i++) &#123;</span><br><span class="line">            final View child = parent.getChildAt(i);</span><br><span class="line">            parent.getDecoratedBoundsWithMargins(child, mBounds);</span><br><span class="line">            final int bottom = mBounds.bottom + Math.round(child.getTranslationY());</span><br><span class="line">            final int top = bottom - mDivider.getIntrinsicHeight();</span><br><span class="line">            mDivider.setBounds(left, top, right, bottom);</span><br><span class="line">            mDivider.draw(canvas);</span><br><span class="line">        &#125;</span><br><span class="line">        canvas.restore();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void drawHorizontal(Canvas canvas, RecyclerView parent) &#123;</span><br><span class="line">        canvas.save();</span><br><span class="line">        final int top;</span><br><span class="line">        final int bottom;</span><br><span class="line">        //noinspection AndroidLintNewApi - NewApi lint fails to handle overrides.</span><br><span class="line">        if (parent.getClipToPadding()) &#123;</span><br><span class="line">            top = parent.getPaddingTop();</span><br><span class="line">            bottom = parent.getHeight() - parent.getPaddingBottom();</span><br><span class="line">            canvas.clipRect(parent.getPaddingLeft(), top,</span><br><span class="line">                    parent.getWidth() - parent.getPaddingRight(), bottom);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            top = 0;</span><br><span class="line">            bottom = parent.getHeight();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        final int childCount = parent.getChildCount();</span><br><span class="line">        for (int i = 0; i &lt; childCount; i++) &#123;</span><br><span class="line">            final View child = parent.getChildAt(i);</span><br><span class="line">            parent.getLayoutManager().getDecoratedBoundsWithMargins(child, mBounds);</span><br><span class="line">            final int right = mBounds.right + Math.round(child.getTranslationX());</span><br><span class="line">            final int left = right - mDivider.getIntrinsicWidth();</span><br><span class="line">            mDivider.setBounds(left, top, right, bottom);</span><br><span class="line">            mDivider.draw(canvas);</span><br><span class="line">        &#125;</span><br><span class="line">        canvas.restore();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void getItemOffsets(Rect outRect, View view, RecyclerView parent,</span><br><span class="line">            RecyclerView.State state) &#123;</span><br><span class="line">        if (mDivider == null) &#123;</span><br><span class="line">            outRect.set(0, 0, 0, 0);</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        if (mOrientation == VERTICAL) &#123;</span><br><span class="line">            outRect.set(0, 0, 0, mDivider.getIntrinsicHeight());</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            outRect.set(0, 0, mDivider.getIntrinsicWidth(), 0);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>1.首先来分析一下 <code>getItemOffsets（）</code> 方法：</p>
<ul>
<li>mDivider 在构造函数中初始化值，为默认的分割线的 drawable 属性值</li>
<li>判断 LayoutManger 的方向，如果是 Vertical，就设置 item 的 bottom 偏移默认分割线的高度，如果是 Horizontal 就设置 item 的 right 偏移默认分割线的宽度</li>
</ul>
<p>2，分析一下 <code>onDraw（）</code> 方法<br> 首先进行 LayoutManger 方向的判断，不同的方向，分割线位置计算不同，我们这里就拿最常用的 Vertical 时的状态来看，所以具体看一下 <code>drawVertical（）</code>方法：</p>
<ul>
<li>首先通过 <code>parent.getClipToPadding()</code> 判断 RecycleView  是否设置这个参数为 true （默认值），如果为 true，那 RecycleView 显示位置区域就不会包含 padding 值的位置，所以需要进行裁剪，否则，显示 padding 区域，也就是 RecycleView 控件本身占的区域</li>
<li>遍历 item </li>
<li>获取 item 的 坐标位置，包含 item 的 insets 设置的偏移值（比如通过 getItemOffsets 设置的）和 margin 值。</li>
<li>计算绘制区域的位置信息</li>
</ul>
<p>可以看到，官方代码是先得到一个 drawable 对象，然后计算出 item 所以的偏移值，包括我们通过 <code>getItemOffsets</code> 设置的分割线的值，先计算出 bottom，然后根据 bottom 计算 top。最后通过 <code>onDraw()</code> 设置 drawable  的位置来达到分割线的效果。<br> 无疑这种考虑的更全面，我的 demo 是默认 RecycleView 和 item 都没有偏移量的情况。 </p>
<p>所以，可以看到，绘制分割线，分割线位置的计算是比较重要的，需要具体情况具体分析。</p>
<h4 id="三-利用-shape-设置分割线"><a href="#三-利用-shape-设置分割线" class="headerlink" title="三. 利用 shape 设置分割线"></a>三. 利用 shape 设置分割线</h4><p>不知道大家有没有注意到刚刚看的默认分割线的类中，暴露了这样一个方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public void setDrawable(@NonNull Drawable drawable) &#123;</span><br><span class="line">       if (drawable == null) &#123;</span><br><span class="line">           throw new IllegalArgumentException(&quot;Drawable cannot be null.&quot;);</span><br><span class="line">       &#125;</span><br><span class="line">       mDivider = drawable;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>既然是通过 <code>mDivider.draw(canvas);</code> 最后来绘制分割线的，那么只要我们修改了 drawable  对象，分割线的样式也会修改。</p>
<p>所以，对于简单的分割线，我们可以在 <code>shape</code> 文件中设置一个分割线的样式，然后通过默认分割线的 <code>setDrawable（）</code>方法设置。</p>
<p>示例代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> DividerItemDecoration itemDecoration = new DividerItemDecoration(this,DividerItemDecoration.VERTICAL);</span><br><span class="line">        itemDecoration.setDrawable(getResources().getDrawable(R.drawable.shape_divider));</span><br><span class="line">         rvCommon.addItemDecoration(itemDecoration );</span><br><span class="line">         </span><br><span class="line">shape:</span><br><span class="line">&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    android:shape=&quot;rectangle&quot;&gt;</span><br><span class="line">    &lt;solid android:color=&quot;#000&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">    &lt;size android:height=&quot;@dimen/space_10&quot;/&gt;</span><br><span class="line">    &lt;stroke android:color=&quot;@color/colorPrimaryDark&quot;</span><br><span class="line">        android:width=&quot;@dimen/space_2&quot;/&gt;</span><br><span class="line">&lt;/shape&gt;</span><br></pre></td></tr></table></figure>
<p>效果：<br><img src="https://i.loli.net/2019/02/10/5c5f84e02faf8.png" alt="6.png"></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>其实分割线的实现很简单，主要掌握 <code>ItemDecoration</code> 内容就好。大致步骤有三点：</p>
<p> <strong>1. 通过 <code>getItemOffset（）</code> 方法设置 item 的偏移量</strong><br> <strong>2. 在 <code>onDraw（）</code>或 <code>onDrawOver（）</code> 方法中完成绘制</strong><br>  <strong>2.1 遍历 item，计算分割线的位置</strong><br>  <strong>2.2 通过 <code>draw（）</code>方法完成绘制</strong></p>
<p>其中需要注意的点有：</p>
<ul>
<li><code>getItemOffset（）</code>方法<strong>作用于 item</strong></li>
<li><code>onDraw（）</code>或 <code>onDrawOver（）</code>  方法<strong>作用于 RecycleView</strong> </li>
<li><code>onDraw（）</code><strong>先于</strong> item 绘制</li>
<li><code>onDrawOver（）</code> <strong>后于</strong> item 绘制</li>
<li>计算分割线位置时需考虑 RecycleView 和 item 自身<strong>偏移量</strong>的问题</li>
</ul>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="https://developer.android.com/reference/android/support/v7/widget/RecyclerView.ItemDecoration" target="_blank" rel="noopener">https://developer.android.com/reference/android/support/v7/widget/RecyclerView.ItemDecoration</a></p>

      
    </div>
    
    
    
<div>
  
    ﻿<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">------------- 本文结束 <i class="fa fa-paw"></i> 感谢您的阅读 -------------</div>
    
</div>

  
</div>
<div>
      
        
      
</div>

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/01/13/RecycleView 系列（1）之 基本使用-数据展示/" rel="next" title="RecycleView 系列（1）之 基本使用-数据展示">
                <i class="fa fa-chevron-left"></i> RecycleView 系列（1）之 基本使用-数据展示
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zOTcwMS8xNjIyOA=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="https://avatars0.githubusercontent.com/u/25956745?s=400&u=3b875396982ce81f05ad70778ceee4e3daf8d909&v=4"
                alt="xiaxiayang" />
            
              <p class="site-author-name" itemprop="name">xiaxiayang</p>
              <p class="site-description motion-element" itemprop="description">万事起于乎微</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#一-ItemDecoration-类介绍"><span class="nav-number">2.</span> <span class="nav-text">一.ItemDecoration 类介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#二-解析默认分割线的实现"><span class="nav-number">3.</span> <span class="nav-text">二.解析默认分割线的实现</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#三-利用-shape-设置分割线"><span class="nav-number">4.</span> <span class="nav-text">三. 利用 shape 设置分割线</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#总结"><span class="nav-number"></span> <span class="nav-text">总结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#参考"><span class="nav-number"></span> <span class="nav-text">参考</span></a></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">xiaxiayang</span>

  
</div>


<!--

  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>



-->
        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  












  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("ByyCi7vrXdGjsa6CpXHlJEvk-gzGzoHsz", "g9aOj0XwnjgbqfEbmmyuBw2O");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  

</body>
</html>
